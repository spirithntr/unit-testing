!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";var r=a(n(1)),i=a(n(4));function a(e){return e&&e.__esModule?e:{default:e}}var s=document.querySelector(".person-list-container");new r.default(i.default,s,[10,15,20])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(2)),a=s(n(3));function s(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(t,n,r){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.view=new a.default(n),this.list=new i.default(t,this.view),this.list.updateData().then(function(e){s.list.personList=e,s.list.sort(),s.setRanges(r),s.list.update(),s.view.sortSelector.addEventListener("change",function(e){return s.sort(e)})}).catch(function(e){s.list.personList=[]})}return r(e,[{key:"update",value:function(){this.list.update()}},{key:"sort",value:function(e){switch(e.currentTarget.value){case"normal":this.list.sort();break;case"reverse":this.list.reverse()}this.list.update()}},{key:"setRanges",value:function(e){this.list.range=this.view.showRanges(e,this),this.list.page=this.view.showPages(this.calcPages(),this)}},{key:"setRangeEvent",value:function(e,t){this.list.range=e,this.view.setRangeActive(t.currentTarget),this.list.page=this.view.showPages(this.calcPages(),this),this.list.update()}},{key:"setPageEvent",value:function(e,t){this.list.page=e,this.view.setPageActive(t.currentTarget),this.list.update()}},{key:"calcPages",value:function(){var e=this.list.personList.length,t=this.list.range;return e%t?Math.floor(e/t)+1:e/t}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=function(e){var t=e.proto+"://"+e.url;for(var n in e.params)t+=n+"="+e.params[n]+"&";return t.slice(0,t.length-1)}(t),this.view=n,this.personList=[]}return r(e,[{key:"sort",value:function(){this.personList.sort(function(e,t){var n=e.name.first+" "+e.name.last,r=t.name.first+" "+t.name.last;return n.localeCompare(r)})}},{key:"reverse",value:function(){this.personList.reverse()}},{key:"updateData",value:function(){var e=this;return new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",e.url,!0),r.responseType="json",r.onreadystatechange=function(){4===r.readyState&&(200!==r.status?console.log(r.status+": "+r.statusText):t(r.response.results))},r.ontimeout=function(){console.log("Извините, запрос превысил максимальное время"),n("timeout")},r.onerror=function(e){console.log("Error: "+e),n(e)},r.send()})}},{key:"update",value:function(){var e=this.page*this.range,t=e+this.range;this.view.showList(this.personList.slice(e,t))}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function i(e){return e.slice(0,1).toUpperCase()+e.slice(1)}function a(e){for(var t=e.children.length,n=0;n<t;n++)e.removeChild(e.firstElementChild)}function s(e,t,n,r){var i=document.createElement(t);for(var a in n)i.setAttribute(a,n[a]);return r&&(i.innerText=r),e.appendChild(i),i}var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=t,this.sortSelector=t.querySelector(".sorting"),this.viewList=t.querySelector(".view-list"),this.ranges=t.querySelector(".ranges"),this.pages=t.querySelector(".pages"),this.modalOverlay=t.querySelector(".modal-overlay"),this.modal=t.querySelector(".full-info")}return r(e,null,[{key:"CLICK",get:function(){return"click"}},{key:"ACTIVE",get:function(){return"active"}},{key:"HIDDEN",get:function(){return"hidden"}}]),r(e,[{key:"showList",value:function(t){var n=this;this.viewList.children.length>0&&a(this.viewList),t.forEach(function(t){var r=document.createElement("li"),a=document.createElement("img"),s=document.createElement("p");a.src=t.picture.thumbnail;var o=t.name,u=o.title,l=o.first,c=o.last;s.innerText=i(u)+". "+i(l)+" "+i(c),r.appendChild(a),r.appendChild(s),r.addEventListener(e.CLICK,function(e){return n.showFullInfo(t,e)}),n.viewList.appendChild(r)})}},{key:"showRanges",value:function(t,n){var r=this;return t.forEach(function(t,i){var a=document.createElement("li"),s=document.createElement("a");i||(s.classList.add(e.ACTIVE),r.activeRange=s),s.innerText=t,s.addEventListener(e.CLICK,function(e){return n.setRangeEvent(t,e)}),a.appendChild(s),r.ranges.appendChild(a)}),t[0]}},{key:"setRangeActive",value:function(t){this.activeRange.classList.remove(e.ACTIVE),this.activeRange=t,this.activeRange.classList.add(e.ACTIVE)}},{key:"showPages",value:function(t,n){var r=this;this.pages.children.length>0&&a(this.pages);for(var i=function(t){var i=document.createElement("li"),a=document.createElement("a");0===t&&(a.classList.add(e.ACTIVE),r.activePage=a),a.innerText=t+1,a.addEventListener(e.CLICK,function(e){return n.setPageEvent(t,e)}),i.appendChild(a),r.pages.appendChild(i)},s=0;s<t;s++)i(s);return 0}},{key:"setPageActive",value:function(t){this.activePage.classList.remove(e.ACTIVE),this.activePage=t,this.activePage.classList.add(e.ACTIVE)}},{key:"showFullInfo",value:function(t,n){var r=this.modalOverlay;r.classList.remove(e.HIDDEN),r.addEventListener(e.CLICK,function(){return r.classList.add(e.HIDDEN)});var o=this.modal;this.modal.children.length>0&&a(this.modal),o.classList.remove(e.HIDDEN),s(o,"img",{src:t.picture.large,alt:t.name.first+" "+t.name.last});var u=s(o,"div",{});s(u,"p",{},"Street: "+function(e){for(var t=e.split(" "),n="",r=0;r<t.length;r++)n+=" "+i(t[r]);return n}(t.location.street)),s(u,"p",{},"City: "+i(t.location.city)),s(u,"p",{},"State: "+i(t.location.state)),s(u,"p",{},"Email: "+t.email),s(u,"p",{},"Phone: "+t.phone)}}]),e}();t.default=o},function(e){e.exports={proto:"https",url:"randomuser.me/api/?",params:{results:"50",format:"json",nat:"us",gender:"",password:"",inc:"gender,name,location,email,phone,picture"}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy93aWRnZXQvcGVyc29ud2lkZ2V0LmpzIiwid2VicGFjazovLy8uL3NyYy93aWRnZXQvcGVyc29ubGlzdC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvd2lkZ2V0L3BlcnNvbnZpZXcuanMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJjb250YWluZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJQZXJzb25XaWRnZXQiLCJjb25maWciLCJyYW5nZXMiLCJfdGhpcyIsInRoaXMiLCJfY2xhc3NDYWxsQ2hlY2siLCJ2aWV3IiwiUGVyc29uVmlldyIsImxpc3QiLCJQZXJzb25MaXN0IiwidXBkYXRlRGF0YSIsInRoZW4iLCJyZXN1bHQiLCJwZXJzb25MaXN0Iiwic29ydCIsInNldFJhbmdlcyIsInVwZGF0ZSIsInNvcnRTZWxlY3RvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsImNhdGNoIiwiZXJyb3IiLCJjdXJyZW50VGFyZ2V0IiwicmV2ZXJzZSIsImFyciIsInJhbmdlIiwic2hvd1JhbmdlcyIsInBhZ2UiLCJzaG93UGFnZXMiLCJjYWxjUGFnZXMiLCJzZXRSYW5nZUFjdGl2ZSIsInNldFBhZ2VBY3RpdmUiLCJwZXJzb25Db3VudCIsImxlbmd0aCIsIk1hdGgiLCJmbG9vciIsInVybCIsInByb3RvIiwicGFyYW1zIiwic2xpY2UiLCJidWlsZFVybCIsInBlcnNvbl9hIiwicGVyc29uX2IiLCJuYW1lX2EiLCJmaXJzdCIsImxhc3QiLCJuYW1lX2IiLCJsb2NhbGVDb21wYXJlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJ4aHIiLCJYTUxIdHRwUmVxdWVzdCIsIm9wZW4iLCJyZXNwb25zZVR5cGUiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJyZWFkeVN0YXRlIiwic3RhdHVzIiwiY29uc29sZSIsImxvZyIsInN0YXR1c1RleHQiLCJyZXNwb25zZSIsInJlc3VsdHMiLCJvbnRpbWVvdXQiLCJvbmVycm9yIiwic2VuZCIsInN0YXJ0IiwiZW5kIiwic2hvd0xpc3QiLCJzZW50ZW5jZUNhc2UiLCJzdHIiLCJ0b1VwcGVyQ2FzZSIsInJlbW92ZUNoaWxkcmVuIiwiY291bnQiLCJjaGlsZHJlbiIsInJlbW92ZUNoaWxkIiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJhZGRFbGVtZW50IiwiZWxlbWVudCIsImF0dHIiLCJjb250ZW50IiwiZWxtIiwiY3JlYXRlRWxlbWVudCIsInNldEF0dHJpYnV0ZSIsImlubmVyVGV4dCIsImFwcGVuZENoaWxkIiwidmlld0xpc3QiLCJwYWdlcyIsIm1vZGFsT3ZlcmxheSIsIm1vZGFsIiwiZm9yRWFjaCIsInBlcnNvbiIsImxpIiwiaW1nIiwicE5hbWUiLCJzcmMiLCJwaWN0dXJlIiwidGh1bWJuYWlsIiwiX3BlcnNvbiRuYW1lIiwidGl0bGUiLCJDTElDSyIsInNob3dGdWxsSW5mbyIsImNvbnRyb2xsZXIiLCJfdGhpczIiLCJpbmRleCIsImEiLCJjbGFzc0xpc3QiLCJhZGQiLCJBQ1RJVkUiLCJhY3RpdmVSYW5nZSIsInNldFJhbmdlRXZlbnQiLCJyZW1vdmUiLCJwYWdlQ291bnQiLCJfdGhpczMiLCJfbG9vcCIsImFjdGl2ZVBhZ2UiLCJzZXRQYWdlRXZlbnQiLCJvdmVyIiwiSElEREVOIiwibGFyZ2UiLCJhbHQiLCJkaXYiLCJzdHJlZXQiLCJhcnJheSIsInNwbGl0IiwicGFyc2VBZGRyZXNzIiwibG9jYXRpb24iLCJjaXR5Iiwic3RhdGUiLCJlbWFpbCIsInBob25lIl0sIm1hcHBpbmdzIjoiYUFDQSxJQUFBQSxFQUFBLEdBR0EsU0FBQUMsRUFBQUMsR0FHQSxHQUFBRixFQUFBRSxHQUNBLE9BQUFGLEVBQUFFLEdBQUFDLFFBR0EsSUFBQUMsRUFBQUosRUFBQUUsR0FBQSxDQUNBRyxFQUFBSCxFQUNBSSxHQUFBLEVBQ0FILFFBQUEsSUFVQSxPQU5BSSxFQUFBTCxHQUFBTSxLQUFBSixFQUFBRCxRQUFBQyxJQUFBRCxRQUFBRixHQUdBRyxFQUFBRSxHQUFBLEVBR0FGLEVBQUFELFFBS0FGLEVBQUFRLEVBQUFGLEVBR0FOLEVBQUFTLEVBQUFWLEVBR0FDLEVBQUFVLEVBQUEsU0FBQVIsRUFBQVMsRUFBQUMsR0FDQVosRUFBQWEsRUFBQVgsRUFBQVMsSUFDQUcsT0FBQUMsZUFBQWIsRUFBQVMsRUFBQSxDQUEwQ0ssWUFBQSxFQUFBQyxJQUFBTCxLQUsxQ1osRUFBQWtCLEVBQUEsU0FBQWhCLEdBQ0Esb0JBQUFpQixlQUFBQyxhQUNBTixPQUFBQyxlQUFBYixFQUFBaUIsT0FBQUMsWUFBQSxDQUF3REMsTUFBQSxXQUV4RFAsT0FBQUMsZUFBQWIsRUFBQSxjQUFpRG1CLE9BQUEsS0FRakRyQixFQUFBc0IsRUFBQSxTQUFBRCxFQUFBRSxHQUVBLEdBREEsRUFBQUEsSUFBQUYsRUFBQXJCLEVBQUFxQixJQUNBLEVBQUFFLEVBQUEsT0FBQUYsRUFDQSxLQUFBRSxHQUFBLGlCQUFBRixRQUFBRyxXQUFBLE9BQUFILEVBQ0EsSUFBQUksRUFBQVgsT0FBQVksT0FBQSxNQUdBLEdBRkExQixFQUFBa0IsRUFBQU8sR0FDQVgsT0FBQUMsZUFBQVUsRUFBQSxXQUF5Q1QsWUFBQSxFQUFBSyxVQUN6QyxFQUFBRSxHQUFBLGlCQUFBRixFQUFBLFFBQUFN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QVc0QyxFQUFLLElBQU8sR0FBdkIsVUFBcUM5QixFQUFPc0MsT0FDNUNwRCxFQUFXNEMsRUFBSyxJQUFPLEdBQXZCLFVBQXFDOUIsRUFBT3VDLDBCQTdHL0IzSCIsImZpbGUiOiJpbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImltcG9ydCBQZXJzb25XaWRnZXQgZnJvbSAnLi93aWRnZXQvcGVyc29ud2lkZ2V0LmpzJztcbmltcG9ydCBjb25maWcgZnJvbSAnLi9jb25maWcuanNvbidcblxuY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBlcnNvbi1saXN0LWNvbnRhaW5lcicpO1xuY29uc3Qgd2lkZ2V0ID0gbmV3IFBlcnNvbldpZGdldChjb25maWcsIGNvbnRhaW5lciwgWzEwLCAxNSwgMjBdKTtcblxuIiwiaW1wb3J0IFBlcnNvbkxpc3QgZnJvbSAnLi9wZXJzb25saXN0LmpzJztcbmltcG9ydCBQZXJzb25WaWV3IGZyb20gJy4vcGVyc29udmlldy5qcyc7XG5cbi8vIGNvbmZpZzogY29uZmlndXJhdGlvbiBmb3IgVVJJXG4vLyBjb250YWluZXI6IERPTSBlbGVtZW50IGZvciB3aWRnZXRcbi8vIHJhbmdlczogYXJyYXkgZm9yIHBlZ2luYXRpb25zXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQZXJzb25XaWRnZXR7XG4gICAgY29uc3RydWN0b3IoY29uZmlnLCBjb250YWluZXIsIHJhbmdlcykge1xuICAgICAgICB0aGlzLnZpZXcgPSBuZXcgUGVyc29uVmlldyhjb250YWluZXIpO1xuICAgICAgICB0aGlzLmxpc3QgPSBuZXcgUGVyc29uTGlzdChjb25maWcsIHRoaXMudmlldyk7XG4gICAgICAgIHRoaXMubGlzdC51cGRhdGVEYXRhKClcbiAgICAgICAgICAgIC50aGVuKCByZXN1bHQgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMubGlzdC5wZXJzb25MaXN0ID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgIHRoaXMubGlzdC5zb3J0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRSYW5nZXMocmFuZ2VzKTtcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3QudXBkYXRlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy52aWV3LnNvcnRTZWxlY3Rvci5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLChldmVudCkgPT4gdGhpcy5zb3J0KGV2ZW50KSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKCBlcnJvciA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5saXN0LnBlcnNvbkxpc3QgPSBbXTtcbiAgICAgICAgICAgICAgICAvLyBUT0RPIFNob3cgRXJyb3JcbiAgICAgICAgICAgIH0pO1xuICAgIH1cbiAgICAvLyB1cGRhdGUgdmlld1xuICAgIHVwZGF0ZSgpIHtcbiAgICAgICAgdGhpcy5saXN0LnVwZGF0ZSgpO1xuICAgIH1cbiAgICAvLyBzZWxlY3QgbGlzdCBzb3J0aW5nXG4gICAgc29ydChldmVudCkge1xuICAgICAgICBzd2l0Y2goIGV2ZW50LmN1cnJlbnRUYXJnZXQudmFsdWUgKSB7XG4gICAgICAgICAgICBjYXNlICdub3JtYWwnIDpcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3Quc29ydCgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAncmV2ZXJzZScgOlxuICAgICAgICAgICAgICAgIHRoaXMubGlzdC5yZXZlcnNlKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5saXN0LnVwZGF0ZSgpXG4gICAgfVxuICAgIHNldFJhbmdlcyhhcnIpIHtcbiAgICAgICAgdGhpcy5saXN0LnJhbmdlID0gdGhpcy52aWV3LnNob3dSYW5nZXMoYXJyLCB0aGlzKTtcbiAgICAgICAgdGhpcy5saXN0LnBhZ2UgID0gdGhpcy52aWV3LnNob3dQYWdlcyh0aGlzLmNhbGNQYWdlcygpLCB0aGlzKTtcbiAgICB9XG4gICAgc2V0UmFuZ2VFdmVudChyYW5nZSwgZXZlbnQpIHtcbiAgICAgICAgdGhpcy5saXN0LnJhbmdlID0gcmFuZ2U7XG4gICAgICAgIHRoaXMudmlldy5zZXRSYW5nZUFjdGl2ZShldmVudC5jdXJyZW50VGFyZ2V0KTtcbiAgICAgICAgdGhpcy5saXN0LnBhZ2UgID0gdGhpcy52aWV3LnNob3dQYWdlcyh0aGlzLmNhbGNQYWdlcygpLCB0aGlzKTtcbiAgICAgICAgdGhpcy5saXN0LnVwZGF0ZSgpO1xuICAgIH1cbiAgICBzZXRQYWdlRXZlbnQocGFnZSwgZXZlbnQpIHtcbiAgICAgICAgdGhpcy5saXN0LnBhZ2UgPSBwYWdlO1xuICAgICAgICB0aGlzLnZpZXcuc2V0UGFnZUFjdGl2ZShldmVudC5jdXJyZW50VGFyZ2V0KTtcbiAgICAgICAgdGhpcy5saXN0LnVwZGF0ZSgpO1xuICAgIH1cbiAgICBjYWxjUGFnZXMoKSB7XG4gICAgICAgIGNvbnN0IHBlcnNvbkNvdW50ID0gdGhpcy5saXN0LnBlcnNvbkxpc3QubGVuZ3RoLFxuICAgICAgICAgICAgICByYW5nZSAgICAgICA9IHRoaXMubGlzdC5yYW5nZTtcbiAgICAgICAgbGV0IGNvdW50UGFnZSA9IDA7XG4gICAgICAgIGlmKCAhKHBlcnNvbkNvdW50ICUgcmFuZ2UpICl7XG4gICAgICAgICAgICBjb3VudFBhZ2UgPSBwZXJzb25Db3VudCAvIHJhbmdlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY291bnRQYWdlID0gTWF0aC5mbG9vciggcGVyc29uQ291bnQgLyByYW5nZSApICsgMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY291bnRQYWdlO1xuICAgIH1cbn1cbiIsIi8vIE1ha2UgVVJJIGZyb20gY29uZmlnIGZvciByZXF1ZXN0XG5mdW5jdGlvbiBidWlsZFVybChjb25maWcpIHtcbiAgICBsZXQgcmVzdWx0ID0gYCR7Y29uZmlnLnByb3RvfTovLyR7Y29uZmlnLnVybH1gO1xuICAgIGZvcihsZXQga2V5IGluIGNvbmZpZy5wYXJhbXMpIHtcbiAgICAgICAgcmVzdWx0ICs9IGAke2tleX09JHtjb25maWcucGFyYW1zW2tleV19JmA7XG4gICAgfVxuICAgIC8vIHJldHVybiBVUkkgd2l0aG91dCBsYXN0ICZcbiAgICByZXR1cm4gcmVzdWx0LnNsaWNlKDAscmVzdWx0Lmxlbmd0aCAtIDEpO1xufVxuLy9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBlcnNvbkxpc3Qge1xuXG4gICAgY29uc3RydWN0b3IoY29uZmlnLCB2aWV3KSB7XG4gICAgICAgIHRoaXMudXJsID0gYnVpbGRVcmwoY29uZmlnKTtcbiAgICAgICAgdGhpcy52aWV3ID0gdmlldztcbiAgICAgICAgdGhpcy5wZXJzb25MaXN0ID0gW107XG4gICAgfVxuICAgIHNvcnQoKSB7XG4gICAgICAgIHRoaXMucGVyc29uTGlzdC5zb3J0KCAocGVyc29uX2EsIHBlcnNvbl9iKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuYW1lX2EgPSBgJHtwZXJzb25fYS5uYW1lLmZpcnN0fSAke3BlcnNvbl9hLm5hbWUubGFzdH1gO1xuICAgICAgICAgICAgY29uc3QgbmFtZV9iID0gYCR7cGVyc29uX2IubmFtZS5maXJzdH0gJHtwZXJzb25fYi5uYW1lLmxhc3R9YDtcbiAgICAgICAgICAgIHJldHVybiBuYW1lX2EubG9jYWxlQ29tcGFyZShuYW1lX2IpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgcmV2ZXJzZSgpIHtcbiAgICAgICAgdGhpcy5wZXJzb25MaXN0LnJldmVyc2UoKTtcbiAgICB9XG4gICAgdXBkYXRlRGF0YSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICAgICAgeGhyLm9wZW4oJ0dFVCcsdGhpcy51cmwsIHRydWUpO1xuICAgICAgICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdqc29uJztcblxuICAgICAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBpZih4aHIucmVhZHlTdGF0ZSAhPT0gNCkgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGlmKHhoci5zdGF0dXMgIT09IDIwMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgJHt4aHIuc3RhdHVzfTogJHt4aHIuc3RhdHVzVGV4dH1gKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHhoci5yZXNwb25zZS5yZXN1bHRzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgeGhyLm9udGltZW91dCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggJ9CY0LfQstC40L3QuNGC0LUsINC30LDQv9GA0L7RgSDQv9GA0LXQstGL0YHQuNC7INC80LDQutGB0LjQvNCw0LvRjNC90L7QtSDQstGA0LXQvNGPJyApO1xuICAgICAgICAgICAgICAgIC8vIFRPRE8gdXBkYXRlIHZpZXdcbiAgICAgICAgICAgICAgICByZWplY3QoJ3RpbWVvdXQnKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB4aHIub25lcnJvciA9IChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBFcnJvcjogJHtlcnJvcn1gKTtcbiAgICAgICAgICAgICAgICAvLyBUT0RPIHVwZGF0ZSB2aWV3XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB4aHIuc2VuZCgpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgdXBkYXRlKCkge1xuICAgICAgICAvLyBDYWxjIGNvdW50IHBhZ2VzXG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gdGhpcy5wYWdlICogdGhpcy5yYW5nZSxcbiAgICAgICAgICAgICAgZW5kICAgPSBzdGFydCArIHRoaXMucmFuZ2U7XG4gICAgICAgIHRoaXMudmlldy5zaG93TGlzdCh0aGlzLnBlcnNvbkxpc3Quc2xpY2Uoc3RhcnQsIGVuZCkpO1xuICAgIH1cbn1cbiIsIi8vIHN0cmluZyAtPiBTdHJpbmdcbmZ1bmN0aW9uIHNlbnRlbmNlQ2FzZShzdHIpIHtcbiAgICByZXR1cm4gc3RyLnNsaWNlKDAsIDEpLnRvVXBwZXJDYXNlKCkgKyBzdHIuc2xpY2UoMSk7XG59XG4vLyBjb252ZXJ0IFwiNDA5MSBsYWtlc2hvcmUgcmRcIiB0byBcIjQwOTEgTGFrZXNob3JlIFJkXCJcbmZ1bmN0aW9uIHBhcnNlQWRkcmVzcyhzdHJlZXQpIHtcbiAgICBjb25zdCBhcnJheSA9IHN0cmVldC5zcGxpdCgnICcpO1xuICAgIGxldCByZXN1bHQgPSAnJztcbiAgICBmb3IobGV0IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgcmVzdWx0ICs9IGAgJHtzZW50ZW5jZUNhc2UoYXJyYXlbaV0pfWA7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG4vLyByZW1vdmUgYWxsIGNoaWxkcmVuXG5mdW5jdGlvbiByZW1vdmVDaGlsZHJlbihjb250YWluZXIpIHtcbiAgICBjb25zdCBjb3VudCA9IGNvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGg7XG5cbiAgICBmb3IobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykge1xuICAgICAgICBjb250YWluZXIucmVtb3ZlQ2hpbGQoY29udGFpbmVyLmZpcnN0RWxlbWVudENoaWxkKTtcbiAgICB9XG59XG4vLyBBZGQgRE9NIEVsZW1lbnQgdG8gY29udGFpbmVyXG5mdW5jdGlvbiBhZGRFbGVtZW50KGNvbnRhaW5lciwgZWxlbWVudCwgYXR0ciwgY29udGVudCkge1xuICAgIGNvbnN0IGVsbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZWxlbWVudCk7XG4gICAgZm9yKGxldCBrZXkgaW4gYXR0cikge1xuICAgICAgICBlbG0uc2V0QXR0cmlidXRlKGtleSwgYXR0cltrZXldKVxuICAgIH1cbiAgICBpZihjb250ZW50KSB7XG4gICAgICAgIGVsbS5pbm5lclRleHQgPSBjb250ZW50O1xuICAgIH1cbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoZWxtKTtcbiAgICByZXR1cm4gZWxtO1xufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQZXJzb25WaWV3IHtcbiAgICAvLyBjbGljayBldmVudFxuICAgIHN0YXRpYyBnZXQgQ0xJQ0soKSB7XG4gICAgICByZXR1cm4gJ2NsaWNrJztcbiAgICB9XG4gICAgLy8gYWN0aXZlIGNzcyBjbGFzc1xuICAgIHN0YXRpYyBnZXQgQUNUSVZFKCkge1xuICAgICAgcmV0dXJuICdhY3RpdmUnO1xuICAgIH1cbiAgICAvLyBoaWRkZW4gY3NzIGNsYXNzXG4gICAgc3RhdGljIGdldCBISURERU4oKSB7XG4gICAgICByZXR1cm4gJ2hpZGRlbic7XG4gICAgfVxuICAgIGNvbnN0cnVjdG9yKGNvbnRhaW5lcikge1xuICAgICAgICB0aGlzLmNvbnRhaW5lciAgICAgPSBjb250YWluZXI7XG4gICAgICAgIHRoaXMuc29ydFNlbGVjdG9yICA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuc29ydGluZycpO1xuICAgICAgICB0aGlzLnZpZXdMaXN0ICAgICAgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLnZpZXctbGlzdCcpO1xuICAgICAgICB0aGlzLnJhbmdlcyAgICAgICAgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLnJhbmdlcycpO1xuICAgICAgICB0aGlzLnBhZ2VzICAgICAgICAgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLnBhZ2VzJyk7XG4gICAgICAgIHRoaXMubW9kYWxPdmVybGF5ICA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcubW9kYWwtb3ZlcmxheScpO1xuICAgICAgICB0aGlzLm1vZGFsID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5mdWxsLWluZm8nKTtcbiAgICB9XG4gICAgc2hvd0xpc3QocGVyc29uTGlzdCkge1xuXG4gICAgICAgIGlmKHRoaXMudmlld0xpc3QuY2hpbGRyZW4ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcmVtb3ZlQ2hpbGRyZW4odGhpcy52aWV3TGlzdCk7XG4gICAgICAgIH1cblxuICAgICAgICBwZXJzb25MaXN0LmZvckVhY2goKHBlcnNvbikgPT4ge1xuICAgICAgICAgICAgY29uc3QgbGkgID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKSxcbiAgICAgICAgICAgICAgICAgIGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpLFxuICAgICAgICAgICAgICAgICAgcE5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gICAgICAgICAgICBpbWcuc3JjID0gcGVyc29uLnBpY3R1cmUudGh1bWJuYWlsO1xuICAgICAgICAgICAgY29uc3QgeyB0aXRsZSwgZmlyc3QsIGxhc3QgfSA9IHBlcnNvbi5uYW1lO1xuICAgICAgICAgICAgcE5hbWUuaW5uZXJUZXh0ID0gYCR7c2VudGVuY2VDYXNlKHRpdGxlKX0uICR7c2VudGVuY2VDYXNlKGZpcnN0KX0gJHtzZW50ZW5jZUNhc2UobGFzdCl9YDtcbiAgICAgICAgICAgIGxpLmFwcGVuZENoaWxkKGltZyk7XG4gICAgICAgICAgICBsaS5hcHBlbmRDaGlsZChwTmFtZSk7XG5cbiAgICAgICAgICAgIGxpLmFkZEV2ZW50TGlzdGVuZXIoUGVyc29uVmlldy5DTElDSywoZXZlbnQpID0+IHRoaXMuc2hvd0Z1bGxJbmZvKHBlcnNvbixldmVudCkpO1xuXG4gICAgICAgICAgICB0aGlzLnZpZXdMaXN0LmFwcGVuZENoaWxkKGxpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHNob3dSYW5nZXMocmFuZ2VzLCBjb250cm9sbGVyKSB7XG4gICAgICAgIHJhbmdlcy5mb3JFYWNoKCAocmFuZ2UsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyksXG4gICAgICAgICAgICAgICAgICBhICA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICAgICAgICAgIGlmKCFpbmRleCkge1xuICAgICAgICAgICAgICAgIGEuY2xhc3NMaXN0LmFkZChQZXJzb25WaWV3LkFDVElWRSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVSYW5nZSA9IGE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhLmlubmVyVGV4dCA9IHJhbmdlO1xuICAgICAgICAgICAgYS5hZGRFdmVudExpc3RlbmVyKFBlcnNvblZpZXcuQ0xJQ0ssIGV2ZW50ID0+IGNvbnRyb2xsZXIuc2V0UmFuZ2VFdmVudChyYW5nZSxldmVudCkpO1xuICAgICAgICAgICAgbGkuYXBwZW5kQ2hpbGQoYSk7XG4gICAgICAgICAgICB0aGlzLnJhbmdlcy5hcHBlbmRDaGlsZChsaSk7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyByZXR1cm4gZGVmYXVsdCByYW5nZVxuICAgICAgICByZXR1cm4gcmFuZ2VzWzBdO1xuICAgIH1cbiAgICBzZXRSYW5nZUFjdGl2ZShlbGVtZW50KSB7XG4gICAgICAgIHRoaXMuYWN0aXZlUmFuZ2UuY2xhc3NMaXN0LnJlbW92ZShQZXJzb25WaWV3LkFDVElWRSk7XG4gICAgICAgIHRoaXMuYWN0aXZlUmFuZ2UgPSBlbGVtZW50O1xuICAgICAgICB0aGlzLmFjdGl2ZVJhbmdlLmNsYXNzTGlzdC5hZGQoUGVyc29uVmlldy5BQ1RJVkUpO1xuICAgIH1cbiAgICBzaG93UGFnZXMocGFnZUNvdW50LCBjb250cm9sbGVyKSB7XG5cbiAgICAgICAgaWYodGhpcy5wYWdlcy5jaGlsZHJlbi5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICByZW1vdmVDaGlsZHJlbih0aGlzLnBhZ2VzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBwYWdlQ291bnQ7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpLFxuICAgICAgICAgICAgICAgICAgYSAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgICAgICAgICBpZiggaSA9PT0gMCApIHtcbiAgICAgICAgICAgICAgICBhLmNsYXNzTGlzdC5hZGQoUGVyc29uVmlldy5BQ1RJVkUpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlUGFnZSA9IGE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhLmlubmVyVGV4dCA9IGkgKyAxO1xuICAgICAgICAgICAgYS5hZGRFdmVudExpc3RlbmVyKFBlcnNvblZpZXcuQ0xJQ0ssIGV2ZW50ID0+IGNvbnRyb2xsZXIuc2V0UGFnZUV2ZW50KGksIGV2ZW50KSk7XG4gICAgICAgICAgICBsaS5hcHBlbmRDaGlsZChhKTtcbiAgICAgICAgICAgIHRoaXMucGFnZXMuYXBwZW5kQ2hpbGQobGkpO1xuICAgICAgICB9XG4gICAgICAgIC8vIHJldHVybiBkZWZhdWx0IHBhZ2VcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIHNldFBhZ2VBY3RpdmUoZWxlbWVudCkge1xuICAgICAgICB0aGlzLmFjdGl2ZVBhZ2UuY2xhc3NMaXN0LnJlbW92ZShQZXJzb25WaWV3LkFDVElWRSk7XG4gICAgICAgIHRoaXMuYWN0aXZlUGFnZSA9IGVsZW1lbnQ7XG4gICAgICAgIHRoaXMuYWN0aXZlUGFnZS5jbGFzc0xpc3QuYWRkKFBlcnNvblZpZXcuQUNUSVZFKTtcbiAgICB9XG4gICAgLy8gbW9kYWwgdmlld1xuICAgIHNob3dGdWxsSW5mbyhwZXJzb24sIGV2ZW50KSB7XG4gICAgICAgIGNvbnN0IG92ZXIgPSB0aGlzLm1vZGFsT3ZlcmxheTtcbiAgICAgICAgb3Zlci5jbGFzc0xpc3QucmVtb3ZlKFBlcnNvblZpZXcuSElEREVOKTtcbiAgICAgICAgb3Zlci5hZGRFdmVudExpc3RlbmVyKFBlcnNvblZpZXcuQ0xJQ0ssKCkgPT4gb3Zlci5jbGFzc0xpc3QuYWRkKFBlcnNvblZpZXcuSElEREVOKSk7XG4gICAgICAgIC8vIHNob3cgbW9kYWwgd2luZG93XG4gICAgICAgIGNvbnN0IG1vZGFsID0gdGhpcy5tb2RhbDtcblxuICAgICAgICBpZih0aGlzLm1vZGFsLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHJlbW92ZUNoaWxkcmVuKHRoaXMubW9kYWwpO1xuICAgICAgICB9XG5cbiAgICAgICAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShQZXJzb25WaWV3LkhJRERFTik7XG4gICAgICAgIGFkZEVsZW1lbnQobW9kYWwsICdpbWcnLCB7IHNyYzogcGVyc29uLnBpY3R1cmUubGFyZ2UsIGFsdDogYCR7cGVyc29uLm5hbWUuZmlyc3R9ICR7cGVyc29uLm5hbWUubGFzdH1gIH0pO1xuICAgICAgICBjb25zdCBkaXYgPSBhZGRFbGVtZW50KG1vZGFsLCAnZGl2Jywge30pO1xuICAgICAgICBhZGRFbGVtZW50KGRpdiwgJ3AnICAsIHt9LCBgU3RyZWV0OiAke3BhcnNlQWRkcmVzcyhwZXJzb24ubG9jYXRpb24uc3RyZWV0KX1gKTtcbiAgICAgICAgYWRkRWxlbWVudChkaXYsICdwJyAgLCB7fSwgYENpdHk6ICR7c2VudGVuY2VDYXNlKHBlcnNvbi5sb2NhdGlvbi5jaXR5KX1gKTtcbiAgICAgICAgYWRkRWxlbWVudChkaXYsICdwJyAgLCB7fSwgYFN0YXRlOiAke3NlbnRlbmNlQ2FzZShwZXJzb24ubG9jYXRpb24uc3RhdGUpfWApO1xuICAgICAgICBhZGRFbGVtZW50KGRpdiwgJ3AnICAsIHt9LCBgRW1haWw6ICR7cGVyc29uLmVtYWlsfWApO1xuICAgICAgICBhZGRFbGVtZW50KGRpdiwgJ3AnICAsIHt9LCBgUGhvbmU6ICR7cGVyc29uLnBob25lfWApO1xuXG4gICAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==